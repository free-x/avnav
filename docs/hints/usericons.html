<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>user icons</title>
    <link href="../styles.css" rel="stylesheet" type="text/css">
  </head>
  <body data-order="6000">
    <h1>Nutzer Symbole</h1>
    <div class="toc"> </div>
    <p>Seit Version 20201030.</p>
    <p>Eine Reihe der in AvNav genutzten Symbole kann man an die eigenen
      Bedürfnisse anpassen. Man kann die vorhanden Symbole in ihrer Größe
      ändern, verschiedene Eigenschaften einstellen, oder sie durch eigene
      Symbole ersetzen.</p>
    <p>Falls man eigene Symbole nutzen möchte, müssen diese als .png Dateien in
      das Images Verzeichnis hochgeladen werden - siehe bei der <a href="../userdoc/downloadpage.html#userfiles">Beschreibung
        zu Nutzer-Dateien</a>.</p>
    <p>Welche Symbole verändert werden sollen (und wie), wird in einer JSON
      Datei im Nutzer Verzeichnis beschrieben - images.json.</p>
    <p>Diese Datei hat den folgenden Aufbau (Beispiel):</p>
    <div class="code">{
  "boatImage": {
    "anchor": [20,0],
    "size":[40,71]
  },<br>  "boatImageHdg:{<br>    "src": "/user/images/SpecialBoat.png",
    "anchor": [15,15],    <br>    "size":[30,70]<br>  }
  "markerImage":{
    "src": "/user/images/Marker.png",
    "anchor": [15,15],
    "size":[30,30]
  },
  "aisNormalImage-Sail":{
    "src": "/user/images/Sail-Boat-40.png",
    "anchor": [15,15],
    "size":[30,30],
    "courseVectorColor": "#ff00ff",
    "rotate":false
  },
  "aisNormalImage-Military":{
    "anchor": [32,0],
    "size":[64,120]
  }
}</div>
    <p>Ab 20230614 existiert eine <a href="https://github.com/wellenvogel/avnav/blob/master/viewer/static/images.json">Basis-Konfiguration</a>
      die das System nutzt. In der Nutzer-Datei können Einträge überschrieben
      werden.</p>
    <p>Für jedes zu ersetzende Symbol muss ein Eintrag mit dem entsprechenden
      Namen existieren.</p>
    <h2>Allgemeine Images</h2>
    <table style="width: 100%" border="1">
      <tbody>
        <tr>
          <td>boatImage</td>
          <td>Das Symbol für das Boot auf der Navigationsseite</td>
        </tr>
        <tr>
          <td>boatImageHdg<br>
            (20220421)</td>
          <td>Das Symbol für das Boot wenn hdm oder hdt zur Anzeige genutzt
            werden</td>
        </tr>
        <tr>
          <td>boatImageSteady<br>
            (20220421)</td>
          <td>Das Symbol für das Boot, wenn zero SOG detect aktiviert ist und
            das Boot sich nicht bewegt</td>
        </tr>
        <tr>
          <td>markerImage</td>
          <td>Das Symbol für den aktuellen Ziel-Wegepunkt</td>
        </tr>
        <tr>
          <td>anchorImage</td>
          <td>Das Symbol für den Anker bei aktiviertem Anker-Alarm</td>
        </tr>
        <tr>
          <td>measureImage</td>
          <td>Das Symbol für den Startpunkt der aktuellen Messung</td>
        </tr>
      </tbody>
    </table>
    <h2>AIS Images</h2>
    <p>Bei den AIS Images gibt es eine ganze Reihe von Optionen. Jedes AIS Ziel
      kann in einem bestimmten Zustand sein (gekennzeichnet durch eine
      entsprechende Farbe)</p>
    <table style="width: 100%" border="1">
      <tbody>
        <tr>
          <td>Zustand</td>
          <td>Bedeutung</td>
        </tr>
        <tr>
          <td>Normal</td>
          <td>AIS Ziel</td>
        </tr>
        <tr>
          <td>Warning</td>
          <td>Das nächste AIS Ziel, das die minimal eingestellte CPA
            unterschreitet</td>
        </tr>
        <tr>
          <td>Tracking</td>
          <td>Das AIS Ziel, das über die AIS Info Seite ausgewählt wurde</td>
        </tr>
        <tr>
          <td>Nearest</td>
          <td>Das nächste AIS Ziel</td>
        </tr>
      </tbody>
    </table>
    <p>Daneben können die AIS Images noch abhängig von der Art (Normal/Aton) und
      verschiedenen Parametern (ship type, navigation status, aid type)
      unterschieden werden.</p>
    <p>Es ist prinzipiell möglich für jede der möglichen Kombinationen ein
      eigenes Icon zu definieren. Einfacher ist es jedoch (ab 20230614) , die
      Handling des Zustandes (Farbe) AvNav zu überlassen. Dazu müssen die Icons
      eine Farbe enthalten, die dann bei der Darstellung durch die entsprechende
      Farbe des Zustandes ersetzt wird. Diese Farbe muss dazu AvNav über den
      Parameter "replaceColor" mitgeteilt werden (siehe die <a href="https://github.com/wellenvogel/avnav/blob/master/viewer/static/images.json">defaults</a>
      für Beispiele).</p>
    <p>Es sind damit im Wesentliche folgende Icon-Angaben möglich (Beispiele):</p>
    <table style="width: 100%" border="1">
      <tbody>
        <tr>
          <td>Key</td>
          <td>Bedeutung</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>aisImage</td>
          <td>default Ais icon</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>aisImage-status1</td>
          <td>Icon für AIS Ziele mit dem navigational Status 1 (At Anchor), für
            eine Liste der Werte siehe den <a href="https://github.com/wellenvogel/avnav/blob/d96104c8db58459d24dee180fa19c5360cab3d69/viewer/nav/aisformatter.jsx#L152">source
              code</a>.</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>aisImage-Fishing</td>
          <td>Icon für AIS Ziele mit dem ship type 30 (Fishing), <a href="https://github.com/wellenvogel/avnav/blob/d96104c8db58459d24dee180fa19c5360cab3d69/viewer/nav/aisformatter.jsx#L120">siehe
              den code</a> für die Werte</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>aisImage-Fishing-status1</td>
          <td>Icon für AIS Ziele mit dem navigational Status 1 (At Anchor) und
            type 30 (Fishing)</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>aisatonImage</td>
          <td>default AIS Icon für atons</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>aisatonImage-type9</td>
          <td>AIS Icon für atons mit type 9 (Beacon, Cardinal N), <a href="https://github.com/wellenvogel/avnav/blob/d96104c8db58459d24dee180fa19c5360cab3d69/viewer/nav/aisformatter.jsx#L256">siehe
              den code</a> für die Werte.</td>
          <td><br>
          </td>
        </tr>
      </tbody>
    </table>
    <p>Das Setzen der Images folgt Prioritäten :</p>
    <ol>
      <li>aisImage-Fishing-status1</li>
      <li>aisImage-Fishing-status* (since 20250812)</li>
      <li>aisImage-status1</li>
      <li>aisImage-Fishing</li>
    </ol>
    <p>Man muss daher beachten, das man eventuell mehrere Einträge machen muss,
      wenn man z.B. für einen Typ ein bestimmtes Icon haben möchte (insbesondere
      vor Version 20250812) - in den defaults gibt es schon Einträge für die
      Status-Werte 1,2,3,4,5,6,7 - man muss dann z.B. für den Typ Passenger
      Einträge für </p>
    <ul>
      <li>aisImage-Passenger-status1</li>
      <li>aisImage-Passenger-status2</li>
      <li>aisImage-Passenger-status3</li>
      <li>aisImage-Passenger-status4</li>
      <li>aisImage-Passenger-status5</li>
      <li>aisImage-Passenger-status6</li>
      <li>aisImage-Passenger-status7</li>
    </ul>
    <p>erzeugen. <br>
      Ab Version 20250812 erlaubt die Definition auch einen "wildcard" Status.
      So kann man für das Beispiel angeben:</p>
    <ul>
      <li>aisImage-Passenger-status*</li>
    </ul>
    <p>Falls man nicht mit "replaceColor" arbeiten möchte, kann man
      unterschiedliche Icons für die Zustände angeben:</p>
    <p>aisWarningImage, aisNormalImage, aisWarningImage-status1, ...</p>
    <h2>Icon Parameter<br>
    </h2>
    Die folgenden Parameter können für jedes Symbol definiert werden:
    <table style="width: 100%" border="1">
      <tbody>
        <tr>
          <td>src</td>
          <td>Die URL für die Image Datei. Typisch /user/images/XYZ.png für eine
            Datei, die über die Download Seite hochgeladen wurde.<br>
            Falls dieser Parameter nicht angegeben wird, wird das in AvNav
            vorhandene Symbol genutzt - man kann aber z.B. mit den anderen
            Parametern die Größe ändern.<br>
            Die Bilddateien sollten ein wenig grösser sein, als das was man bei
            size angibt - z.B. Faktor 2 (aber nicht zu gross, da sonst die
            Performance leidet). Wenn man Vektorgrafiken hat, kann man z.B. <a
              href="https://inkscape.org">inkscape</a> nutzen, um daraus png's
            zu erzeugen</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>size</td>
          <td>[breite,höhe] - muss als Array (siehe Beispiel) angegeben werden.
            Das beschreibt die Größe des Symbols (die Bilddatei wird auf diese
            Größe skaliert).<br>
            Falls man keinen src Parameter angibt, kann man hiermit die Größe
            des internen Symbols verändern. </td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>anchor</td>
          <td>[x,y] - der Punkt des Symbols (bezogen auf Breite und Höhe), der
            auf die aktuelle Position auf der Karte gesetzt werden soll.</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>rotate</td>
          <td>true oder false - wenn auf false gesetzt, wird das Symbol nicht
            entsprechend des aktuellen Kurses rotiert</td>
          <td>nicht für markerImage</td>
        </tr>
        <tr>
          <td>courseVector</td>
          <td>true oder false - wenn auf false, wird für dieses Symbol kein
            Voraus-Vektor gezeichnet (auch wenn es über die Einstellungen aktiv
            ist)</td>
          <td>nicht für markerImage</td>
        </tr>
        <tr>
          <td>courseVectorColor</td>
          <td>die Farbe für den course Vektor. Hier kann man eine Farbe wählen,
            die zu den genutzten Bildern passt.</td>
          <td>nicht für markerImage</td>
        </tr>
        <tr>
          <td>replaceColor<br>
            (ab 20230614)</td>
          <td>Die Farbe, die je nach Zustand zu ersetzen ist</td>
          <td>nur ais...Image</td>
        </tr>
        <tr>
          <td>textOffset<br>
            (ab 20230614)</td>
          <td>Ein Array [x,y] für den Basis-Text-Offset. Zusätzlich wird noch
            ein weiterer Offset je nach Kurs berechnet (primär y). Der X Wert
            muss sich an der Größe des Icons (size Parameter) orientieren</td>
          <td>nur ais...lImage</td>
        </tr>
      </tbody>
    </table>
    <p>Nicht angegebene Parameter werden jeweils durch default Werte ersetzt. Es
      ist auch möglich, für bestimmte Kombinationen nur Parameter anzugeben und
      kein eigenes Icon - damit kann man z.B. die AIS Symbole unterschiedlich
      groß gestalten. Typischerweise muss bei Änderung von size auch anchor
      geändert werden.</p>
    <p>Bei der Bearbeitung der images.json muss darauf geachtet werden, valides
      json zu erzeugen. Wenn man es innerhalb von AvNav auf der Files/Download
      Seite <img src="../viewerimages/icons-new/ic_file_download.svg" alt="" class="inlineimage">(Unterseite
      <img src="../viewerimages/icons-new/folder_shared.svg" alt="" class="inlineimage">)
      bearbeitet, wird beim Speichern automatisch eine Syntax-Prüfung
      vorgenommen. </p>
    <p><img src="edit-images.png" alt="" class="fimage"></p>
    <p> Nach der Änderung von images.json muss AvNav neu geladen werden.</p>
    <p><br>
    </p>
  </body>
</html>
